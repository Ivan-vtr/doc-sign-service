{% extends "web/base.html" %}
{% load static %}
{% block title %}Подписание: {{ document_title }} - DocSign{% endblock %}

{% block content %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        {% if is_package %}
        <li class="breadcrumb-item"><a href="{% url 'web-packages' %}">Пакеты</a></li>
        {% else %}
        <li class="breadcrumb-item"><a href="{% url 'web-dashboard' %}">Документы</a></li>
        {% endif %}
        <li class="breadcrumb-item active">Подписание</li>
    </ol>
</nav>

<div class="card">
    <div class="card-header">
        <h4 class="mb-0" style="font-weight:700;font-size:1.1rem">Подписание: {{ document_title }}</h4>
    </div>
    <div class="card-body py-4">
        <div id="signing-container"
             data-document-id="{% if not is_package %}{{ document_id }}{% endif %}"
             data-package-id="{% if is_package %}{{ document_id }}{% endif %}">

            <div class="text-center mb-3">
                <p id="signing-status" class="signing-status">Инициализация сессии подписания...</p>
                <span id="signing-spinner" class="loading-spinner" style="width:2rem;height:2rem;border-width:3px;color:var(--brand)"></span>
            </div>

            <div class="qr-container" style="display:none" id="qr-section">
                <img id="qr-image" src="" alt="QR-код" style="display:none">
                <div id="signing-links" class="mt-3"></div>
                <p style="color:var(--text-secondary);font-size:.8rem;margin-top:1rem">
                    Отсканируйте QR-код приложением eGov Mobile или нажмите ссылку на вашем телефоне.
                </p>
            </div>

            <div id="signing-result"></div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'web/js/signing.js' %}"></script>
{% endblock %}
